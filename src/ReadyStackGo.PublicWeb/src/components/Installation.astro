---
import { t, type Lang } from '../i18n/translations';
import { getInstallCommand, getInstallCommandWithPort, config } from '../config';

interface Props {
	lang?: Lang;
}

const { lang = 'de' } = Astro.props;

// Get install commands from config (uses current origin for dynamic URL)
const installCmd = getInstallCommand(Astro.url.origin);
const installCmdWithPort = getInstallCommandWithPort(3000, Astro.url.origin);

const content = {
	de: {
		title: 'In 60 Sekunden einsatzbereit',
		subtitle: 'Unser Bootstrap-Script kümmert sich um alles: Docker-Installation, Container-Setup und Konfiguration. Du brauchst nur einen Linux-Server mit Root-Zugriff.',
		req1: 'Ubuntu, Debian, CentOS, Fedora',
		req1_sub: '',
		req1_note: 'Nur Ubuntu 20.04+ wird offiziell unterstützt',
		req2: 'Root-Zugriff',
		req2_sub: '– via sudo oder direkter Root-Login',
		req3: 'Internetzugang',
		req3_sub: '– für Docker und Image-Downloads',
		download: 'Script direkt herunterladen',
		startButton: 'Zur Installationsanleitung',
		terminal: 'Terminal',
		comment1: '# Standard Installation (Port 8080)',
		comment2: '# Mit alternativem Port',
		output1: 'Docker wurde installiert',
		output2: 'ReadyStackGo laeuft jetzt!',
	},
	en: {
		title: 'Ready in 60 Seconds',
		subtitle: 'Our bootstrap script handles everything: Docker installation, container setup and configuration. You just need a Linux server with root access.',
		req1: 'Ubuntu, Debian, CentOS, Fedora',
		req1_sub: '',
		req1_note: 'Only Ubuntu 20.04+ is officially supported',
		req2: 'Root Access',
		req2_sub: '– via sudo or direct root login',
		req3: 'Internet Access',
		req3_sub: '– for Docker and image downloads',
		download: 'Download script directly',
		startButton: 'View Installation Guide',
		terminal: 'Terminal',
		comment1: '# Standard Installation (Port 8080)',
		comment2: '# With alternative port',
		output1: 'Docker has been installed',
		output2: 'ReadyStackGo is now running!',
	},
};

const c = content[lang];
---

<section id="installation" class="py-20 lg:py-28 bg-gray-50 dark:bg-gray-800">
	<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
		<div class="grid lg:grid-cols-2 gap-12 items-center">
			<!-- Left: Text content -->
			<div>
				<span class="text-brand-500 font-semibold text-theme-sm uppercase tracking-wide">Installation</span>
				<h2 class="text-title-md sm:text-title-lg font-bold text-gray-900 dark:text-white mt-3 mb-6">
					{c.title}
				</h2>
				<p class="text-gray-500 dark:text-gray-400 text-theme-xl mb-8">
					{c.subtitle}
				</p>

				<!-- Requirements -->
				<div class="space-y-4 mb-8">
					<div class="flex items-start gap-3">
						<div class="w-6 h-6 bg-success-100 dark:bg-success-500/20 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5">
							<svg class="w-4 h-4 text-success-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
							</svg>
						</div>
						<div>
							<span class="font-medium text-gray-900 dark:text-white">{c.req1}</span>
							<span class="text-gray-500 dark:text-gray-400"> {c.req1_sub}</span>
							<span class="block text-xs text-gray-400 dark:text-gray-500 mt-0.5">{c.req1_note}</span>
						</div>
					</div>
					<div class="flex items-start gap-3">
						<div class="w-6 h-6 bg-success-100 dark:bg-success-500/20 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5">
							<svg class="w-4 h-4 text-success-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
							</svg>
						</div>
						<div>
							<span class="font-medium text-gray-900 dark:text-white">{c.req2}</span>
							<span class="text-gray-500 dark:text-gray-400"> {c.req2_sub}</span>
						</div>
					</div>
					<div class="flex items-start gap-3">
						<div class="w-6 h-6 bg-success-100 dark:bg-success-500/20 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5">
							<svg class="w-4 h-4 text-success-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
							</svg>
						</div>
						<div>
							<span class="font-medium text-gray-900 dark:text-white">{c.req3}</span>
							<span class="text-gray-500 dark:text-gray-400"> {c.req3_sub}</span>
						</div>
					</div>
				</div>

				<a href="/install.sh" download class="inline-flex items-center gap-2 text-brand-500 hover:underline font-medium">
					<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
					</svg>
					{c.download}
				</a>
			</div>

			<!-- Right: Code block -->
			<div class="bg-gray-900 rounded-2xl p-6 shadow-theme-xl">
				<div class="flex items-center gap-2 mb-4">
					<div class="w-3 h-3 rounded-full bg-error-500"></div>
					<div class="w-3 h-3 rounded-full bg-warning-500"></div>
					<div class="w-3 h-3 rounded-full bg-success-500"></div>
					<span class="ml-4 text-gray-400 text-theme-sm">{c.terminal}</span>
				</div>

				<div class="font-mono text-sm space-y-4">
					<!-- Command 1: Standard installation -->
					<div>
						<div class="text-gray-400 mb-1">{c.comment1}</div>
						<div class="flex items-start gap-2">
							<span class="text-success-500">$</span>
							<code class="text-blue-light-500 break-all">{installCmd}</code>
						</div>
					</div>

					<!-- Command 2: Custom port -->
					<div>
						<div class="text-gray-400 mb-1">{c.comment2}</div>
						<div class="flex items-start gap-2">
							<span class="text-success-500">$</span>
							<code class="text-blue-light-500 break-all">{installCmdWithPort}</code>
						</div>
					</div>

					<!-- Output -->
					<div class="border-t border-gray-700 pt-4 mt-4">
						<div class="text-gray-400">
							<span class="text-success-500">[OK]</span> {c.output1}<br>
							<span class="text-success-500">[OK]</span> {c.output2}<br>
							<span class="text-brand-400">URL:</span> http://192.168.1.100:8080
						</div>
					</div>
				</div>
			</div>

			<!-- Button below terminal -->
			<div class="lg:col-start-2 flex justify-center lg:justify-end mt-6 lg:mt-0">
				<a
					href={`/${lang}/getting-started/installation/`}
					class="inline-flex items-center justify-center gap-2 px-8 py-4 bg-brand-500 text-white font-semibold rounded-xl hover:bg-brand-600 transition-all shadow-theme-sm hover:shadow-theme-lg"
				>
					<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
					</svg>
					{c.startButton}
				</a>
			</div>
		</div>
	</div>
</section>
